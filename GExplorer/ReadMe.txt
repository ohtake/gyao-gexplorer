パソコンテレビ GyaO 専用ブラウザ GExplorer 2.0.8.1

◆概要
株式会社USENによる「パソコンテレビGyaO」を閲覧するためのブラウザです．
・ジャンルごとのコンテンツの一覧を取得できます．
・プレイリストを作成し内蔵のプレーヤで連続再生ができます．

◆必要な環境
.NET Framework 2.0 が必要です．
Windows Vista ではプリインストールされています．
Windows 98, Me, 2000, XP, 2003 ではインストールが必要です．
Windows 95 にはインストールできません．

.NET Framework 2.0 は Microsoft Update や Windows Update などで入手できますが
デフォルトでは選択されません．
「高速」ではなく「カスタム」を選択するようにし
「追加選択(ソフトウェア)」で .NET Framework 2.0 を追加してください．

手作業でインストールする方法もありますが
CPUごとに別々のインストーラが用意されているので注意してください．
Microsoft .NET Framework Version 2.0 再頒布可能パッケージ (x86)
http://www.microsoft.com/downloads/details.aspx?FamilyID=0856eacb-4362-4b0d-8edd-aab15c5e04f5&DisplayLang=ja
Microsoft .NET Framework Version 2.0 再頒布可能パッケージ (x64)
http://www.microsoft.com/downloads/details.aspx?FamilyID=b44a0000-acf8-4fa1-affb-40e78d788b00&DisplayLang=ja
Microsoft .NET Framework Version 2.0 再頒布可能パッケージ (IA64)
http://www.microsoft.com/downloads/details.aspx?FamilyID=53c2548b-bec7-4ab4-8cbe-33e07cfc83a7&DisplayLang=ja

◆Windowsのバージョンによる機能の制限
・Windows 98, Me, 2000 では以下の機能が利用できません．
　　・設定 > グローバル設定 > GUI > ビジュアルスタイル
　　・クロール結果ビューでのパッケージごとに分類された表示
　　・デフォルトのアイコンの正常な表示
・Windows 98 では以下の機能が利用できません．
　　・プレイヤフォームでのメディアキー
　　・ウェブブラウザでの拡張ボタン

◆インストールと実行
GExplorer-x_x_x_x.zip をまるごと展開してください．
同じディレクトリに同梱されている dll も必須です．
実行ファイルのあるディレクトリに設定ファイル等を保存するため，
ディレクトリに書き込む権限があることも必要です．
展開後に GExplorer.exe を実行すれば起動できます．

◆アンインストール
ディレクトリごと削除すればOKです．
GExplorer自身はレジストリに書き込みを行いません．

◆バージョンアップ
GExplorer-x_x_x_x.zip ないの全ファイルを旧バージョンのファイルに
上書きしてください．
旧バージョンの設定ファイルやキャッシュはなるべく読み込めるように
努力はしていますが，2つ以上前のバージョンからのバージョンアップは
ほとんどテストしていません．
古いバージョンへの巻き戻しは一切考えていないので留意しておいてください．

◆C/Migemo
クロール結果のフィルタ処理を行うために C/Migemo を利用できます．
C/Migemo がなくても GExplorer は動作しますが，あったほうが便利です．

KaoriYa.net
http://www.kaoriya.net/#CMIGEMO

上記サイトから「バイナリ(DLL)リリース版 for Windows」をダウンロード．
必須ファイルは migemo.dll と dict ディレクトリ内の全辞書ファイル．
migemo.dll と dict を GExplorer.exe と同じディレクトリにおいてください．

◆クッキー
動画を再生する場合に IE に GyaO のクッキーが食わせてあることが必要です．
あらかじめ IE でユーザ登録を済ませておいてください．

◆プロクシ
インターネットオプションで設定されているプロクシを利用します．
ドキュメントの内容を書き換えうるプロクシがあると
GyaO のウェブページの解釈に失敗する可能性があります．

◆操作方法
◇ジャンルタブ (メイン画面の左上)
パソコンテレビGyaOのジャンルの一覧です．
タブを選択すると選択されたジャンルのクロール結果ビューに表示します．
タブをダブルクリックすることでクロールをかけられます．
初回のクロールではキャッシュがたまっていないため時間がかかります．
タブを右クリックすることもできます．

◇クロール結果ビュー (メイン画面の左中)
コンテンツの一覧を表示します．
ダブルクリックやEnterキーによりプレイリストに追加できます．
右クリックやドラッグも可能です．

◇プレイリストビュー (メイン画面の左下)
ダブルクリックやEnterキーにより専用プレーヤで再生します．
右クリック，ドラッグ，ドロップも可能です．

◇詳細ビュー (メイン画面の右)
リストビューで選択した項目の画像や情報を表示します．
画像部分は右クリック可能です．

◇専用プレーヤ
パソコンテレビGyaOの動画の再生に特化したWMPベースのプレーヤです．
プレイリストの順に連続再生します．

◇ウェブブラウザ
パソコンテレビGyaOの閲覧用にIEベースのウェブブラウザを内蔵しています．
パッケージIDまたはコンテンツIDを抽出できたエレメントにマウスオーバーすると
吹き出しが出て，クリックするとメニューが出ます．
Altキーを押していれば吹き出しもメニューも出なくなります．
グローバル設定で内臓のウェブブラウザを使わない設定にしてある場合でも
カタログ表示の時には内臓のウェブブラウザが使われます．

◇外部コマンド
他のプログラムに引数を渡すことでユーザが自由に動作を拡張できます．
・表示名
　　適当に入力してください．
　　&を使うと次の文字がナビゲーションキーになります．
　　表示名を - とするとセパレータになります．
・実行ファイル
　　実行するプログラムのファイル名を入力します．
　　%ProgramFiles% などの環境変数も使えます．
　　実行ファイル名を空欄にした場合には，後述の引数で指定される
　　URIまたはファイルを開くことになります．
・引数
　　ここで指定した文字列がプログラムを実行する時の引数に使われます．
　　引数で指定する文字列では { と } で囲まれる箇所に置換が起きます．
　　{ と } で囲まれた箇所にはコンテンツのプロパティ名を指定します．
　　プロパティ名は詳細ビューの詳細タブで確認することが出来ます．
　　例として {ContentId} は cnt0123456 といった文字列に置換されます．
　　複数項目を選択した状態で外部コマンドを実行した場合では，
　　各プロパティ値がスペース区切りで置換されます．
　　引数にリテラル文字としての { や } を指定するには
　　{{ または }} と入力してください．
・引数のURLエンコード (省略可能)
　　置換後の文字列に対してURLエンコードを適用したい場合には，
　　{Title:UTF-8} のようにしてプロパティ名の後ろにコロンを置き
　　さらにその後にコードページ名を書きます．
　　日本語の文字列をURLエンコードする場合によく使われるエンコードは
　　UTF-8, Shift_JIS, EUC-JP くらいです．
・使用例1 (どのように置換されるかを確認するためのサンプル)
　　表示名:       IDとコンテンツ名をコマンドプロンプトに表示(&T)
　　実行ファイル: %ComSpec%
　　引数:         /K "echo {ContentId} {DisplayName}"
・使用例2 (URLエンコードの使用例)
　　表示名:       タイトルでGoogle検索(&G)
　　実行ファイル: 
　　引数:         http://www.google.com/search?q={Title:UTF-8}

◇NGコンテンツ
NGを登録することで見たくないコンテンツを非表示に出来ます．
主語，述語，目的語を指定することで条件を記述します．
・コメント
　　意味ないです．分かりやすい説明でもつけてやってください．
・主語
　　コンテンツのプロパティ名を選択します．
　　指定したプロパティの値に対してNG処理をかけます．
　　各プロパティの説明は詳細ビューの詳細タブで確認してください．
・述語
　　Equals:     主語の値が目的語の語句と完全一致したらNG
　　Contains:   主語の値が目的語の語句を含んでいたらNG
　　StartsWith: 主語の値が目的語の語句で始まったらNG
　　EndsWith:   主語の値が目的語の語句で終わったらNG
・目的語
　　上記の述語の目的語となる語句を指定します．
・判定高速化の対象となるNGコンテンツ
　　主語が ContentId または PackageId または Title であり尚且つ述語が Equals の
　　NGコンテンツに限って他とは別の処理をすることでNG処理を高速化させています．
　　なるべく高速化対象となりうるNGコンテンツの記述法を使ってください．
・NGコンテンツの条件の削除
　　アプリケーションの動作速度の悪化を防ぐために
　　最終True日時の古い条件は削除してください．
　　NG/FAVコンテンツエディタで Delete キーにより削除できます．
・使用例1 (高速化の対象となる記述方法)
　　コメント:     NGID cnt0123456
　　プロパティ名: ContentId
　　比較方法:     Equals
　　NGワード:     cnt0123456
・使用例2 (高速化の対象とならない記述方法)
　　コメント:     R18指定
　　プロパティ名: Summary
　　比較方法:     Contains
　　NGワード:     R18指定

◇FAVコンテンツ
NGコンテンツと同様の方法でお気に入りのコンテンツの条件を登録できます．
FAVコンテンツの条件に合致し尚且つに新着であるコンテンツは
クロール終了時にプレイリストに自動で追加されます．
FAVコンテンツでもNGコンテンツと同様の判定高速化を利用しているので
なるべく高速化対象となる記述方法を使ってください．
また動作速度の悪化を防ぐために不要なFAVコンテンツの条件を
定期的に削除してください．

◆既知の不具合
・64bitでの動作
　　・CoCreateInstance で REGDB_E_CLASSNOTREG となって再生ができないらしい
　　・Migemo が使えないらしい (再コンパイルすればいいのか？)
・マルチモニタ環境での動作がおかしいらしい．
・[画面のプロパティ] [スクリーンセーバー] [パスワードによる保護] が有効だと
　スクリーンセーバの抑止が出来ない．
・動画部分を右クリックしてから何も選択せずにコンテキストメニューを閉じると
　動画部分をダブルクリックしても全画面にならなくなる．
・他たくさん

◆謝辞
CMか否かの判定を行うのに参考にした神ソース
http://pc8.2ch.net/test/read.cgi/esite/1116115226/81
アイコン提供
http://pc8.2ch.net/test/read.cgi/esite/1118420039/13
http://pc8.2ch.net/test/read.cgi/esite/1126011881/756

◆お約束の文章
プログラムの作成と配布について株式会社USENから許可は得ていません．
プログラムの実行によって損害等が起きても自己責任です．
鯖の負荷となりうる必要以上のクロールは自粛しましょう．
ソースの取り扱いについては面倒なことが起きない程度で適当にどうぞ．
バイナリの取り扱いも同様です．
