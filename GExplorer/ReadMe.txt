GyaO 専用ブラウザ GExplorer 2.0.0.0

◆概要
株式会社USENによる「パソコンテレビGyaO」を閲覧するためのブラウザです．
・ジャンルごとのコンテンツの一覧を取得できます．
・プレイリストを内蔵しコンテンツを連続再生ができます．
・内蔵のプレーヤで快適に再生できます．

◆必要な環境
.NET Framework 2.0 が必要です．
ただし Windows のバージョンによっては一部の機能に制限があります．

Microsoft .NET Framework Version 2.0 Redistributable Package (x86)
http://www.microsoft.com/downloads/details.aspx?FamilyID=0856eacb-4362-4b0d-8edd-aab15c5e04f5&DisplayLang=en

64bit版の Windows を使っている場合は上記のページにある
「Related Downloads」を辿っていってください．

◆Windowsのバージョンによる機能の制限
Windows 98, Me, 2000 では以下の機能が利用できません．
・クロール結果ビュー > 設定 > パッケージごとに分類
・グローバル設定 > GUI > ビジュアルスタイル
・デフォルトのアイコンの正常な表示

◆インストールと実行
GExplorer-x_x_x_x.zip をまるごと展開してください．
同じディレクトリに同梱されている dll などは必須です．
実行ファイルのあるディレクトリに設定ファイル等を保存するため，
ディレクトリに書き込む権限があることも必要です．
展開後に普通に GExplorer.exe を実行すれば起動できます．

◆アンインストール
ディレクトリごと削除すればOKです．
GExplorer自身はレジストリに書き込みを行いません．

◆バージョンアップ
GExplorer-x_x_x_x.zip ないの全ファイルを旧バージョンのファイルに
上書きしてください．
旧バージョンの設定ファイルやキャッシュはなるべく読み込めるように
努力はしています．

◆C/Migemo
クロール結果のフィルタ処理を行うために C/Migemo を利用できます．
C/Migemo がなくても GExplorer は動作しますが，あったほうが便利です．

KaoriYa.net
http://www.kaoriya.net/#CMIGEMO

上記サイトから「バイナリ(DLL)リリース版 for Windows」をダウンロード．
必須ファイルは migemo.dll と dict ディレクトリ内の全辞書ファイル．
migemo.dll と dict を GExplorer.exe と同じディレクトリにおいてください．

◆操作方法
・ユーザIDの読み取り
　　・起動時にユーザIDを読み取ります
　　・起動前に IE でのユーザ登録を済ませておいてください
　　・以下の順序で読み取りを試みます
　　　　・ActiveX の GyaOTool が利用しているレジストリを読む
　　　　・ファイルシステムからクッキーを読む
　　　　・IE 経由で www.gyao.jp にアクセスしてクッキーを読む
　　・ユーザIDの自動取得に失敗したら GExplorer は起動できません
・ジャンルタブ (メイン画面の上部)
　　・読み込んでいないジャンルのタブを選択すると読み込む
　　・タブをダブルクリックすると強制的に読み込みなおす
　　・右クリック可能
・クロール結果ビュー (メイン画面の左中)
　　・ダブルクリックやEnterキーによりプレイリストに追加する
　　・右クリックすれば他の操作も行えたりする
　　・今回のクロールで初めて発見したコンテンツは別色で表示される
　　・フィルタが黄色い時は正規表現が複雑すぎるか文法エラー
　　・ドラッグ可能
・プレイリストビュー (メイン画面の左下)
　　・ダブルクリックやEnterキーにより専用プレーヤで再生する
　　・右クリックすれば他の操作も行えたりする
　　・ドラッグとドロップが可能
・詳細ビュー (メイン画面の右)
　　・リストビューで選択した項目の情報が表示される
　　・画像部分は右クリック可能
・専用プレーヤ
　　・特に説明は要らないでしょう
・ウェブブラウザ
　　・点線で囲まれた箇所をクリックするとメニューが出ます
　　・Altキーを押したままクリックすればメニューが出ずに
　　　通常のクリックとして扱われます
・グローバル設定エディタ
　　・設定項目を選択すると下部に説明が出ます
　　・説明文が途中で切れてしまうことがあるのでウィンドウを大きめにするとよい
　　・一部の設定項目はGExplorerの再起動が必要になります
・外部コマンドエディタ
　　・表示名
　　　　・適当に入力してください
　　　　・&を使うと次の文字がナビゲーションキーになります
　　・ファイル名
　　　　・実行するプログラムのファイル名を入力します
　　　　・%ProgramFiles% などの環境変数も使えます
　　・引数
　　　　・引数で指定する文字列では { と } で囲まれる箇所に置換が起きます
　　　　・{ と } で囲まれた箇所にはコンテンツのプロパティ名を指定します
　　　　・プロパティ名は詳細ビューの詳細タブで確認することが出来ます
　　　　・例として {MediaFileUri} は
　　　　　rtsp://wms.cd.gyao.jp/gyaovod01?QueryString=contentsId=cntXXXXXXX:userNo=XXXXX:rateId=bit0000002
　　　　　といった文字列に置換されます
　　　　・複数項目を選択した状態で外部コマンドを実行した場合，
　　　　　各プロパティ値がスペース区切りで置換されます
　　　　・引数にリテラル文字としての { や } を指定するには
　　　　　{{ または }} と入力してください
・NGコンテンツエディタ
　　・コメント
　　　　・意味ないです．分かりやすい説明でもつけてやってください
　　・プロパティ名(主語)
　　　　・コンテンツのプロパティ名を選択します
　　　　・指定したプロパティの値に対してNG処理をかけます
　　　　・各プロパティの説明は詳細ビューの詳細タブで確認してください
　　・比較方法(述語)
　　　　・Equals:     プロパティの値がNGワードと完全一致したらNG
　　　　・Contains:   プロパティの値がNGワードを含んでいたらNG
　　　　・StartsWith: プロパティの値がNGワードで始まったらNG
　　　　・EndsWith:   プロパティの値がNGワードで終わったらNG
　　・NGワード(目的語)
　　　　・この語句を含んでいたりするコンテンツをNGにします

◆ジャンル，パッケージ，コンテンツ，チャプターの関係
ジャンル:   映画，音楽，ドラマなど
パッケージ: 「全シリーズを見る」を押した時に見ることが出来るコンテンツの集合
コンテンツ: 1本のビデオと対等
チャプター: CMごとの区切り

推測ではあるがGyaOのコンテンツDBは
ジャンル - パッケージ - コンテンツ - チャプター
という木構造になっているはず．

◆各種設定ファイル
各種設定ファイルは UserSettings ディレクトリに設定を保存しています．
バージョンアップ後に読み込んだら以前の設定が消えることがあるかもしれません．
もしうまく読み込めなくなってしまったら設定ファイルを削除してください．

◆キャッシュ
Cache ディレクトリにキャッシュを置くことで通信量の削減を図っています．
再放送が始まった時に古いキャッシュが残ったままだと
表示内容が古いままのことがあります．
古いキャッシュを自動的に消すことはないので，
定期的に以下のメニューを実行してください．
・ツール > キャッシュの削除 > 到達不可キャッシュの削除
・ツール > 配信期限辞書の整理 > 到達不可エントリーの削除

◆既知の不具合 (解決方法不明)
・プレーヤフォームを閉じた後に動作が不安定になりがち
　(再生を停止させてからウィンドウを閉じるとよい)
・マルチモニタ環境での動作 (確認する環境がないからどうしようもないような)
・[画面のプロパティ] [スクリーンセーバー] [パスワードによる保護] が有効だと
　スクリーンセーバの抑止が出来ないことがある
・WMP10の環境ではWMPダブルクリックで全画面に移ることが出来るはずだが，
　ダブルクリックしても全画面に行かないことがある．
　右クリックからのコンテキストメニューで一旦全画面にすればその後は解決する．
・詳細ビューの画像が一時的に読み込まれなくなる状態になってしまうことがある
・プロパティグリッドで説明文が途中で切れてしまう
・全画面での再生時に右上の×を押しても閉じられない
・他たくさん

◆既知の不具合 (面倒だから放置)
・ウェブブラウザのアドレスバーでEnterキーが拾えない
・WMPやIEにフォーカスがあるとメニューのショートカットキーが拾えない

◆謝辞
CMか否かの判定を行うのに参考にした神ソース
http://pc8.2ch.net/test/read.cgi/esite/1116115226/81
アイコン提供
http://pc8.2ch.net/test/read.cgi/esite/1118420039/13
http://pc8.2ch.net/test/read.cgi/esite/1126011881/756

◆お約束の文章
プログラムの作成と配布について株式会社USENから許可等はもらっていません．
プログラムの実行によって損害等が起きても自己責任です．
鯖の負荷となりうる必要以上のクロールは自粛しましょう．
ソースの取り扱いについては面倒なことが起きない程度で適当にどうぞ．
バイナリの取り扱いも同様です．
