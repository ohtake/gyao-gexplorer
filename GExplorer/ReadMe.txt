GyaO 専用ブラウザ GExplorer 1.2.3.5

◆必要な環境
.NET Framework 2.0.50215 がインストールされており正常に動作していること

Microsoft .NET Framework 2.0 再頒布可能パッケージ Beta 2 (x86)
http://www.microsoft.com/downloads/details.aspx?displaylang=ja&FamilyID=7abd8c8f-287e-4c7e-9a4a-a4ecff40fc8e

まだβ製品しかないけれども 2ch でうｐされているプログラムを実行するほどの度胸のある人ならMSのβ製品なんて恐るるに足らんでしょう

◆C/Migemo
クロール結果のフィルタ処理を行うために C/Migemo を利用します
C/Migemo がなくても GExplorer は動作しますが，あると便利です

KaoriYa.net
http://www.kaoriya.net/#CMIGEMO

上記サイトから「バイナリ(DLL)リリース版 for Windows」をダウンロード
必須ファイルは migemo.dll と dict ディレクトリ内の全辞書ファイル
migemo.dll と dict を GExplorer.exe と同じディレクトリにおいてください

C/Migemoの初期化に失敗するとMigemoフィルタの背景色が赤くなりエラーメッセージが表示されます

◆使用期限
ライセンスの都合により
(i) 2006-05-01
(ii) Visual Studio 2005 の製品版の発売から30日後
のどちらか早い方までしか使用できません

Go-Live License
http://lab.msdn.microsoft.com/vs2005/golive/license/default.aspx

◆インストールと実行
GExplorer-x_x_x_x.zip をまるごと展開してください
同じディレクトリに同梱されている dll などは必須です
展開後に普通に GExplorer.exe を実行すれば起動できます

◆アンインストール
ディレクトリごと削除すればOKです
GExplorer自身はレジストリに書き込みを行いません

◆バージョンアップ
GExplorer-x_x_x_x.zip ないの全ファイルを旧バージョンのファイルに上書きしてください
旧バージョンの設定ファイルやキャッシュはなるべく読み込めるように努力はしています

◆操作方法
・ユーザIDの自動取得
	GExplorer 起動前に IE で GyaO のユーザ登録を済ませておいてください
	以下の順序で取得を試みます
		ActiveX の GyaOTool が利用しているレジストリを読む
		ファイルシステムからクッキーを読む
		IE 経由で www.gyao.jp にアクセスしてクッキーを読む
	ユーザIDの自動取得に失敗したら GExplorer は起動できません
・ジャンルタブ (メイン画面の上部)
	読み込んでいないジャンルのタブを選択すると読み込む
	タブをダブルクリックすると強制的に読み込みなおす
	右クリック可能
・クロール結果ビュー (メイン画面の左中)
	ダブルクリックやEnterキーによりプレイリストに追加する
	右クリックすれば他の操作も行えたりする
	今回のクロールで初めて発見したコンテンツは別色で表示される
	Migemoフィルタが赤い時はC/Migemoの初期化エラー，黄色い時は変換エラー (複雑すぎる正規表現など)
・プレイリストビュー (メイン画面の左下)
	ダブルクリックやEnterキーにより専用プレーヤで再生する
	右クリックすれば他の操作も行えたりする
・詳細ビュー (メイン画面の右)
	リストビューで選択した項目の情報が表示される
	画像部分は右クリック可能
・専用プレーヤ
	特に説明は要らないかと
・ウェブブラウザ
	点線で囲まれた箇所をクリックするとメニューが出ます
	Altキーを押したままクリックすればメニューが出ずに通常のクリックとして扱われます
・グローバル設定エディタ
	設定項目を選択すると下部に説明が出ます
	説明文が途中で切れちゃうことがあるのでウィンドウを大きめにするとよいです
	一部の設定項目はGExplorerの再起動が必要になります
・外部コマンドエディタ
	表示名とファイル名は普通に入力してください
	引数で指定する文字列では { と } で囲まれる箇所に置換が起きます
	{ と } で囲まれた箇所にはコンテンツのプロパティ名を指定します
	プロパティ名は詳細ビューの詳細タブで確認することが出来ます
	例として {MediaFileUri} は rtsp://wms.cd.gyao.jp/gyaovod01?QueryString=contentsId=cntXXXXXXX:userNo=XXXXX:rateId=bit0000002 といった文字列に置換されます
	複数項目を選択した状態で外部コマンドを実行した場合，各プロパティ値がスペース区切りで置換されます
・NGコンテンツエディタ
	コメント
		意味ないです
		分かりやすい説明でもつけてやってください
	プロパティ名(主語)
		コンテンツのプロパティ名を選択します
		指定したプロパティの値に対してNG処理をかけます
		各プロパティの説明は詳細ビューの詳細タブで確認してください
	比較方法(述語)
		Equals:     プロパティの値がNGワードと完全一致したらNG
		Contains:   プロパティの値がNGワードを含んでいたらNG
		StartsWith: プロパティの値がNGワードで始まったらNG
		EndsWith:   プロパティの値がNGワードで終わったらNG
	NGワード(目的語)
		この語句を含んでいたりするコンテンツをNGにします

◆ジャンル，パッケージ，コンテンツの関係
ジャンル:   映画，音楽，ドラマなど
パッケージ: 「全シリーズを見る」のボタンを押した時に見ることが出来るコンテンツの集合
コンテンツ: 1本のビデオと対等
推測ではあるがGyaOのコンテンツDBは以下の木構造になっているはず
ジャンル
  └─パッケージ
        └─コンテンツ

◆各種設定ファイル
各種設定ファイルは UserSettings ディレクトリに設定を保存しています
バージョンアップ後に読み込んだら以前の設定が消えることがあるかもしれません
もしうまく読み込めなくなってしまったら設定ファイルを削除してください

◆コンテンツのキャッシュ
Cache ディレクトリにコンテンツのキャッシュを置くことで通信量の削減を図っています

◆既知の不具合
マルチモニタ環境での動作 (確認する環境がないからどうしようもないような)
詳細ビューの画像が一時的に読み込まれなくなる状態になってしまうことがある
ウェブブラウザのアドレスバーでEnterキーが拾えない
WMPやIEにフォーカスがあるとメニューのショートカットキーが効かない
プロパティグリッドで説明文が途中で切れてしまう
全画面での再生時に右上の×を押しても閉じられない
外部コマンドで置換後の文字列に { や } が入っていたら動かなくなる (面倒だから放置)
他たくさん

◆ソースを弄ってカスタマイズしたい
Visual C# 2005 Express Edition のβ製品を拾ってくるのがよいかと
http://lab.msdn.microsoft.com/express/vcsharp/

◆謝辞
CMか否かの判定を行うのに下記の神のソースを参考にしました
http://pc8.2ch.net/test/read.cgi/esite/1116115226/81
アイコン提供
http://pc8.2ch.net/test/read.cgi/esite/1118420039/13
