GyaO 専用ブラウザ GExplorer 2.0.0.2

◆概要
株式会社USENによる「パソコンテレビGyaO」を閲覧するためのブラウザです．
・ジャンルごとのコンテンツの一覧を取得できます．
・プレイリストを内蔵しコンテンツを連続再生ができます．
・内蔵のプレーヤで快適に再生できます．

◆必要な環境
.NET Framework 2.0 が必要です．
ただし Windows のバージョンによっては一部の機能に制限があります．

Microsoft .NET Framework Version 2.0 Redistributable Package (x86)
http://www.microsoft.com/downloads/details.aspx?FamilyID=0856eacb-4362-4b0d-8edd-aab15c5e04f5&DisplayLang=en

64bit版の Windows を使っている場合は上記のページにある
「Related Downloads」を辿っていってください．

◆Windowsのバージョンによる機能の制限
Windows 98, Me, 2000 では以下の機能が利用できません．
・クロール結果ビュー > 設定 > パッケージごとに分類
・グローバル設定 > GUI > ビジュアルスタイル
・デフォルトのアイコンの正常な表示

◆インストールと実行
GExplorer-x_x_x_x.zip をまるごと展開してください．
同じディレクトリに同梱されている dll などは必須です．
実行ファイルのあるディレクトリに設定ファイル等を保存するため，
ディレクトリに書き込む権限があることも必要です．
展開後に GExplorer.exe を実行すれば起動できます．

◆アンインストール
ディレクトリごと削除すればOKです．
GExplorer自身はレジストリに書き込みを行いません．

◆バージョンアップ
GExplorer-x_x_x_x.zip ないの全ファイルを旧バージョンのファイルに
上書きしてください．
旧バージョンの設定ファイルやキャッシュはなるべく読み込めるように
努力はしています．

◆C/Migemo
クロール結果のフィルタ処理を行うために C/Migemo を利用できます．
C/Migemo がなくても GExplorer は動作しますが，あったほうが便利です．

KaoriYa.net
http://www.kaoriya.net/#CMIGEMO

上記サイトから「バイナリ(DLL)リリース版 for Windows」をダウンロード．
必須ファイルは migemo.dll と dict ディレクトリ内の全辞書ファイル．
migemo.dll と dict を GExplorer.exe と同じディレクトリにおいてください．

◆操作方法
◇ユーザIDの読み取り
GyaOを利用する際にはユーザIDが必要となるため
GExplrerは起動時にユーザIDを読みにいきます．
そのためには起動前に IE でのユーザ登録を済ませておいてください．
ユーザIDの自動取得に失敗したら GExplorer は起動できません．
以下の順序で読み取りを試みます．
・ActiveX の GyaOTool が利用しているレジストリを読む
・ファイルシステムからクッキーを読む
・IE 経由で http://www.gyao.jp/about/ にアクセスしてクッキーを読む

◇ジャンルタブ (メイン画面の上部)
GyaOのジャンルの一覧です．
読み込んでいないジャンルのタブを選択すると読み込みます．
タブをダブルクリックすると強制的に読み込みなおします．
タブを右クリックするこもできます．

◇クロール結果ビュー (メイン画面の左中)
ジャンルタブで選択されたジャンルに含まれるであろうコンテンツの一覧を表示します．
ダブルクリックやEnterキーによりプレイリストに追加できます．
コンテンツを選択してからすれば他の操作も行えます．
右クリックやドラッグも可能です．

◇プレイリストビュー (メイン画面の左下)
ダブルクリックやEnterキーにより専用プレーヤで再生します．
右クリック，ドラッグ，ドロップも可能です．

◇詳細ビュー (メイン画面の右)
リストビューで選択した項目の画像や情報を表示します．
画像部分は右クリック可能です．

◇専用プレーヤ
GyaOの動画の再生に特化したWMPベースのプレーヤです．

◇ウェブブラウザ
GyaOの閲覧に特化したIEベースのウェブブラウザを内蔵しています．
点線で囲まれた箇所をクリックするとメニューが出ます．
グローバル設定で内蔵のウェブブラウザを無効にできます．

◇グローバル設定エディタ
GExplorerの全体的な設定を変更するためのエディタです．
一部の設定項目はGExplorerの再起動が必要になります．

◇外部コマンドエディタ
他のプログラムに引数を渡すことでユーザが自由に動作を拡張できます．
・表示名
　　適当に入力してください．
　　&を使うと次の文字がナビゲーションキーになります．
・ファイル名
　　実行するプログラムのファイル名を入力します．
　　%ProgramFiles% などの環境変数も使えます．
・引数
　　ここで指定した文字列がプログラムを実行する時の引数に使われます．
　　引数で指定する文字列では { と } で囲まれる箇所に置換が起きます．
　　{ と } で囲まれた箇所にはコンテンツのプロパティ名を指定します．
　　プロパティ名は詳細ビューの詳細タブで確認することが出来ます．
　　例として {ContentId} は cnt0123456 といった文字列に置換されます．
　　複数項目を選択した状態で外部コマンドを実行した場合では，
　　各プロパティ値がスペース区切りで置換されます．
　　引数にリテラル文字としての { や } を指定するには
　　{{ または }} と入力してください．

◇NGコンテンツエディタ
NGを登録することで見たくないコンテンツを非表示に出来ます．
クロール結果ビューを右クリックすることで簡単にNGを追加できますが，
当エディタを使うことで追加することも出来ます．
NGが増えすぎると動作が遅くなるので，最終あぼ〜ん日時が古いNGを
定期的に削除してください．
・コメント
　　・意味ないです．分かりやすい説明でもつけてやってください
・プロパティ名(主語)
　　・コンテンツのプロパティ名を選択します
　　・指定したプロパティの値に対してNG処理をかけます
　　・各プロパティの説明は詳細ビューの詳細タブで確認してください
・比較方法(述語)
　　・Equals:     プロパティの値がNGワードと完全一致したらNG
　　・Contains:   プロパティの値がNGワードを含んでいたらNG
　　・StartsWith: プロパティの値がNGワードで始まったらNG
　　・EndsWith:   プロパティの値がNGワードで終わったらNG
・NGワード(目的語)
　　・この語句を含んでいたりするコンテンツをNGにします

◆ジャンル，パッケージ，コンテンツ，チャプターの関係
ジャンル:   映画，音楽，ドラマなど
パッケージ: 「全シリーズを見る」を押した時に見ることが出来るコンテンツの集合
コンテンツ: 1本のビデオと対等
チャプター: CMごとの区切り

推測ではあるがGyaOのコンテンツDBは
ジャンル - パッケージ - コンテンツ - チャプター
という木構造になっているはず．

◆各種設定ファイル
各種設定ファイルは UserSettings ディレクトリに設定を保存しています．
バージョンアップ後に読み込んだら以前の設定が消えることがあるかもしれません．
もしうまく読み込めなくなってしまったら設定ファイルを削除してください．

◆キャッシュ
Cache ディレクトリにキャッシュを置くことで通信量の削減を図っています．
再放送が始まった時に古いキャッシュが残ったままだと
表示内容が古いままのことがあります．
古いキャッシュを自動的に消すことはないので，
定期的に以下のメニューを実行してください．
・ツール > キャッシュの削除 > 到達不可キャッシュの削除
・ツール > 配信期限辞書の整理 > 到達不可エントリーの削除

◆既知の不具合 (解決方法不明)
・プレーヤフォームを閉じた後に動作が不安定になりがち
　(再生を停止させてからウィンドウを閉じるとよい)
・マルチモニタ環境での動作 (確認する環境がないからどうしようもないような)
・[画面のプロパティ] [スクリーンセーバー] [パスワードによる保護] が有効だと
　スクリーンセーバの抑止が出来ないことがある
・WMP10の環境ではWMPダブルクリックで全画面に移ることが出来るはずだが，
　ダブルクリックしても全画面に行かないことがある．
　右クリックからのコンテキストメニューで一旦全画面にすればその後は解決する．
・詳細ビューの画像が一時的に読み込まれなくなる状態になってしまうことがある
・全画面での再生時に右上の×を押しても閉じられない
・他たくさん

◆既知の不具合 (面倒だから放置)
・WMPやIEにフォーカスがあるとメニューのショートカットキーが拾えない

◆謝辞
CMか否かの判定を行うのに参考にした神ソース
http://pc8.2ch.net/test/read.cgi/esite/1116115226/81
アイコン提供
http://pc8.2ch.net/test/read.cgi/esite/1118420039/13
http://pc8.2ch.net/test/read.cgi/esite/1126011881/756

◆お約束の文章
プログラムの作成と配布について株式会社USENから許可等はもらっていません．
プログラムの実行によって損害等が起きても自己責任です．
鯖の負荷となりうる必要以上のクロールは自粛しましょう．
ソースの取り扱いについては面倒なことが起きない程度で適当にどうぞ．
バイナリの取り扱いも同様です．
