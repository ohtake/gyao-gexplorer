GyaO 専用ブラウザ GExplorer 1.1.4.1

◆必要な環境
.NET Framework 2.0.50215 以降がインストールされており正常に動作していること

Microsoft .NET Framework 2.0 再頒布可能パッケージ Beta 2 (x86)
http://www.microsoft.com/downloads/details.aspx?displaylang=ja&FamilyID=7abd8c8f-287e-4c7e-9a4a-a4ecff40fc8e

まだβ製品しかないけれども 2ch でうｐされているプログラムを実行するほどの度胸のある人ならMSのβ製品なんて恐るるに足らんでしょう

◆実行方法
普通に GExplorer.exe を実行する
同じディレクトリに AxInterop.WMPLib.dll と Interop.WMPLib.dll などがあること

◆アンインストール方法
ファイルを丸ごと削除する
.NET Framework 2.0 も必要なければこれもアンインストールする

◆操作方法
・ユーザIDの自動取得
	GExplorer 起動前に IE で GyaO のユーザ登録を済ませておくこと
	ユーザIDの自動取得に失敗したら GExplorer は起動できません
	ユーザ設定にIDが保存されていたらこの処理は必要ありません
・ジャンルタブ
	読み込んでいないジャンルのタブを選択すると読み込む
	タブをダブルクリックすると強制的に読み込みなおす
・リストビュー
	ダブルクリックやEnterキーにより専用プレーヤで再生する
	リスト内を右クリックすれば他の操作も行えたりする
	新着の動画にはアイコンに赤い星印がつく
	特集ページ付きパッケージの中のコンテンツはアイコンがHTMLのものになる
・専用プレーヤ
	特に説明は要らないかと
・ウェブブラウザ
	点線で囲まれた箇所をクリックするとメニューが出ます
	Altキーを押したままクリックすればメニューが出ずに通常のクリックとして扱われます
	外部コマンドも一応は利用できますがパッケージやジャンルの情報を(内部的に)参照する場合は無理です
	再生ページを表示した状態で「再生ページでのテスト」を実行すると幸せになれるかもしれません
・ユーザ設定ツールボックス
	特に説明は要らないかと
・コンテンツプロパティビューア
	特に説明は要らないかと
・外部コマンドエディタ
	表示名とファイル名は普通に入力してください
	引数で指定する文字列では { と } で囲まれる箇所に置換が起きます
	書式は {[クラスの指定子]:[プロパティ名]} となります
	[クラスの指定子] には c, p, g のいずれかが指定でき，それぞれコンテンツ，パッケージ，ジャンルの意味になります
	[プロパティ名] には [クラスの指定子] に対応するクラスのプロパティの名前を指定します
	プロパティ名はコンテンツプロパティビューアで確認することが出来ます
	たとえば {c:MediaFileUri} は rtsp://wms.cd.gyao.jp/gyaovod01?QueryString=contentsId=cntXXXXXXX:userNo=XXXXX:rateId=bit0000002 といった文字列に置換されます
	複数のコンテンツを選択した状態で外部コマンドを実行した場合，各々のプロパティがスペース区切りになった状態で置換されます
	参考までにサンプルの UserCommands.xml を Samples ディレクトリに添付しておきます
・NGパッケージエディタ
	コメント
		意味ないです
		分かりやすい説明でもつけてやってください
	プロパティ名(主語)
		パッケージのプロパティ名を選択します
		指定したプロパティの値に対してNG処理をかけます
		各プロパティの説明はコンテンツプロパティビューアで確認して下さい
	比較方法(述語)
		Equals:     プロパティの値がNGワードと完全一致したらNG
		Contains:   プロパティの値がNGワードを含んでいたらNG
		StartsWith: プロパティの値がNGワードで始まったらNG
		EndsWith:   プロパティの値がNGワードで終わったらNG
	NGワード(目的語)
		この語句を含んでいたりするパッケージをNGにします
	参考までにサンプルの NgPackages.xml を Samples ディレクトリに添付しておきます

◆ジャンル，パッケージ，コンテンツの関係
ジャンル:   映画，音楽，ドラマなど
パッケージ: 「全シリーズを見る」のボタンを押した時に見ることが出来るコンテンツの集合
コンテンツ: 1本のビデオと対等
推測ではあるがGyaOのコンテンツDBは以下の木構造になっているはず
ジャンル
  └─パッケージ
        └─コンテンツ

◆各種設定ファイル
UserSettings.xml, UserCommands.xml, NgPackages.xml に設定を保存しています
バージョンアップ後に読み込んだら以前の設定が消えることがあるかもしれません
もしうまく読み込めなくなってしまったら設定ファイルを削除してください

◆未対応のジャンル
パッケージIDが不明な映画と音楽は現在のロジックのままでは無理
ニュースは実際とは違うものが表示されているようですがあまり気にせずに

◆既知の不具合
並行取得がうまくいかない環境があるらしい
マルチモニタ環境での動作 (確認する環境がないからどうしようもないような)
全画面表示時に右上の×を押しても閉じられない
ユーザ設定ツールボックスの説明文が途中で切れちゃう
外部コマンドで置換後の文字列に { や } が入っていたら動かなくなる (面倒だから放置)

◆ソースを弄ってカスタマイズしたい
Visual C# 2005 Express Edition のβ製品を拾ってくるのがよいかと
http://lab.msdn.microsoft.com/express/vcsharp/

◆謝辞
CMか否かの判定を行うのに下記の神のソースを参考にしました
http://pc8.2ch.net/test/read.cgi/esite/1116115226/81
アイコン提供
http://pc8.2ch.net/test/read.cgi/esite/1118420039/13

